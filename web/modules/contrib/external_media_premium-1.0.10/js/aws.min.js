!function(e,i,n){"use strict";i.behaviors.ExternalMediaAWS={attach:function(n,t){e(".form-type-external-media a."+t.aws_class+", .webform-submission-form a."+t.aws_class,n).unbind().click(function(n){i.behaviors.emwCore.popupHtml(e(this),t.aws_redirect_url,1050,650),n.preventDefault()})}},function t(){if("undefined"!=typeof AWS){var r=n.aws_bucket_name;AWS.config.region=n.aws_region,AWS.config.credentials=new AWS.CognitoIdentityCredentials({IdentityPoolId:n.aws_identity_pool_id});var a=new AWS.S3({apiVersion:"2006-03-01",params:{Bucket:r}}),o={home:"home.png",css:"css.png",doc:"doc.png",file:"file.png",flv:"flv.png",folder:"folder.png",gif:"gif.png",jpg:"jpg.png",mp3:"mp3.png",pdf:"pdf.png",png:"png.png",psd:"psd.png",swf:"swf.png",txt:"txt.png",xlsx:"xlsx.png",xls:"xlsx.png",php:"php.png",zip:"zip.png"};i.behaviors.emwCore.initViewer("file",function(t,r,l,d,s,p){var c=[],f=e(".external-media-widget-popup .fetched-items"),m=e("#emw-loader"),u=e("#aws-breadcrumbs"),v="";function h(n){m.css("display","flex"),f.html("");var r={Delimiter:"/"};if(null!==n&&"/"!==n){var o=encodeURIComponent(n)+"/",l=decodeURIComponent(o);c.indexOf(l)<=-1&&c.push(l),r={Prefix:l}}else c.push("/");u.html(""),u.append(g(null,!1,!0));var d=0;c.forEach(function(e){c.length-1==d?u.append(g(e.slice(0,-1),!1,!1)):u.append(g(e.slice(0,-1),!0,!1)),d++}),a.listObjects(r,function(n,r){if(n)return alert("There was an error listing your objects: "+n.message);var a=this.request.httpRequest,l=a.endpoint.protocol+"//"+a.endpoint.hostname+"/",d=r.CommonPrefixes.map(function(e){return decodeURIComponent(e.Prefix.replace("/",""))}),s=r.Contents.map(function(e){var i=e.Key,n=l+encodeURIComponent(i),t="/"==i.slice(-1)?"folder":"file";return{fileUrl:"file"==t?n:i.slice(0,-1),fileName:"file"==t?i.replace(o,""):i.replace(o,"").slice(0,-1),type:t}});d.length&&d.forEach(function(e){f.append(function(e){return`<div class="flex-item item-folder" data-folder="${e}" data-type="folder">\n              <div class="icon"><img src="${$("folder",null)}" border="0" /></div>\n              <div class="name">${e}</div>\n            </div>`}(e))}),s.length&&s.forEach(function(e){var n,r,a,o,l,d,s,p,c,m;v!=e.fileName&&f.append((n=e.fileUrl,r=e.fileName,a=e.type,o=r.split("/").pop(),l=o.split(".").pop(),d=i.behaviors.emwCore.selectedClass(t,n),s="file"==a?"item-pick":"",p="file"==a?`data-file="${n}"`:`data-folder="${n}"`,c="folder"==a?"item-folder":"item-file",m="file"==a?'<div class="checked">&#10004;</div>':"","file"==a?`<div class="flex-item ${s}${d} ${c} ${a}" ${p}  data-type="${a}">\n                ${m}\n                <div class="icon">${function(e,i,n){if("png"==n||"jpg"==n||"gif"==n||"png"==n){var t=(r=i,(a=new Image).src=r,a.naturalWidth>a.naturalHeight?"landscape":a.naturalWidth<a.naturalHeight?"portrait":"even");return`<div class="img-thumbnail ${t}"><img src="${i}" border="0" onerror="this.src='${$("locked",n)}';this.onerror='';" /></div>`}var r,a;return`<img src="${$("file",n)}" border="0" onerror="this.src='${$("locked",n)}';this.onerror='';" />`}(0,n,l)}</div>\n                <div class="name">${o}</div>\n              </div>`:`<div class="flex-item ${s}${d} ${c} ${a}" ${p}  data-type="${a}">\n                ${m}\n                <div class="icon"><img src="${$("folder",null)}" border="0" /></div>\n                <div class="name">${o}</div>\n              </div>`))}),""==f.html()&&f.append('<div class="no-items-text"><span>The directory either empty or files do not match allowed file extensions.</span></div>'),f.find(".item-pick").sort(function(i,n){return e(i).attr("data-type")-e(n).attr("data-type")}).appendTo(".external-media-widget-popup .fetched-items"),m.hide()})}function g(e,i,n){if(n)return`<div class="item-breadcrumb" data-folder="/"><div class="root"><img src="${$("home",null)}" border="0" /></div></div>`;var t=i?` data-folder="${e}"`:"",r=e.split("/").pop();return""!==r?`<div class="item-breadcrumb"${t}><div><img src="${$("folder",null)}" border="0" /> <div>${r}</div></div></div>`:void 0}function $(e,i){return"folder"==e?n.aws_icons_path+o.folder:"home"==e?n.aws_icons_path+o.home:"locked"==e?n.aws_icons_path+o.file:o.hasOwnProperty(i)?n.aws_icons_path+o[i]:n.aws_icons_path+o.file}h("/"),e(document).on("dblclick",".item-folder",function(i){h(v=e(this).data("folder")),i.preventDefault()}),e(document).on("click",".item-breadcrumb",function(i){c=[],void 0!==(v=e(this).data("folder"))&&h(v),i.preventDefault()})})}else setTimeout(t,250)}()}(jQuery,Drupal,drupalSettings);