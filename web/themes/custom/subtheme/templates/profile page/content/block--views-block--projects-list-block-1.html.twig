{#
/**
 * @file
 * Default theme implementation to display a block.
 *
 * Available variables:
 * - plugin_id: The ID of the block implementation.
 * - label: The configured label of the block if visible.
 * - configuration: A list of the block's configuration values.
 *   - label: The configured label for the block.
 *   - label_display: The display settings for the label.
 *   - provider: The module or other provider that provided this block plugin.
 *   - Block plugin specific settings will also be stored here.
 * - content: The content of this block.
 * - attributes: array of HTML attributes populated by modules, intended to
 *   be added to the main container tag of this template.
 *   - id: A valid HTML ID and guaranteed unique.
 * - title_attributes: Same as attributes, except applied to the main title
 *   tag that appears in the template.
 * - content_attributes: Same as attributes, except applied to the main content
 *   tag that appears in the template.
 * - title_prefix: Additional output populated by modules, intended to be
 *   displayed in front of the main title tag that appears in the template.
 * - title_suffix: Additional output populated by modules, intended to be
 *   displayed after the main title tag that appears in the template.
 *
 * @see template_preprocess_block()
 *
 * @ingroup themeable
 */
#}
<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>

{{ attach_library('bootstrap_barrio_subtheme/unbxd-styling-article-slider') }}
<div class="profile-column profile-chart">
    <div id="search_graph_div" style="display:flex;position: absolute;top: 33px;right: 32px;align-items: center;"><span style="display:inline-block;margin-right:5px;margin-left:5px;color:#004c7a;">From</span> <input id="fromdate" type="date" placeholder="From"><span style="display:inline-block;margin-right:5px;margin-left:5px;color:#004c7a"> To </span><input id="todate" type="date" placeholder="To"><button id="showbutton" style=" background: #004c7a; color: white; border-color: #004c7a; border-radius: 5px; margin-left: 5px;}">Show</button></div>
 <div id="chartWrapper">
  <canvas id="myChart" width="400" height="200"></canvas>
 </div>



</div>

<!-- ATM its hidden via css file global /home/runcloud/webapps/polarseal/web/themes/custom/subtheme/sass/unbxd/global.scss -->
<div class="profile-column projects-list">

<p class="column_header">ALL RUNNING PROJECTS</p>


{{ drupal_view('projects_list', 'block_1') }}


</div>





<script type="text/javascript">
function formatDate(date) {
    var d = new Date(date),
        month = (d.getMonth() + 1),
        day = d.getDate(),
        year = d.getFullYear();
  
    return [day, month, year].join('-');
}
function getToday() {
  var today = new Date();
  today.setDate('01');
  var enddate = today.toISOString().split('T')[0];
  var oneYr = new Date();
  oneYr.setDate('01');
  oneYr.setYear(today.getFullYear() -5);
  var startdate = oneYr.toISOString().split('T')[0];
  return [startdate,enddate];
}
//check how many project exist (based on generated column)
document.addEventListener("DOMContentLoaded", function(event) {
  jQuery("#showbutton").click(function() {
    updateGraph(jQuery('#fromdate').val(),jQuery('#todate').val());
  });
var datearr = getToday();
jQuery('#fromdate').val(datearr[0]);
jQuery('#todate').val(datearr[1]);
updateGraph(datearr[0],datearr[1]);
function updateGraph(from,to) {
  jQuery('#myChart').remove();
  jQuery('#chartWrapper').append('<canvas id="myChart" width="400" height="200"></canvas>');
  jQuery.get('/polar_seal/gen-chart/'+from+'/'+to,function(data) {
  console.log(data);
  const ctx = document.getElementById('myChart');
  const labels = [];
  const colors = [];
  const values = [];
  for (const [key, value] of Object.entries(data.data)) {
   labels.push(key);
   values.push(value);
   colors.push('rgba(75, 120, 250, 0.2)');
  }
  console.log(labels);
  console.log(values);
  console.log(colors);
const myChartvar = new Chart(ctx, {
    type: 'bar',
    data: {
        labels : labels,
        datasets: [{
            label: 'GBP Spent',
            data: values,
            backgroundColor: colors,
            borderColor: colors,
            borderWidth: 1
        }]
    },
    options: {
        scales: {
            y: {
                beginAtZero: true
            }
        }
    }
});
 myChartvar = new Chart(
    document.getElementById('myChart'),
    config
  );
});
}

var number = jQuery('.view-projects-list').find('.views-col').length;

if(number==0)
{
jQuery('.projects-list').append('<h3>You have no project running</h3>');
}


  jQuery('#article_slider').slick({
    slidesToShow: 2,
    slidesToScroll: 1,
    autoplay: true,
  responsive: [
    {
      breakpoint: 999,
      settings: {
        slidesToShow: 1,
        slidesToScroll: 1,
      }
    }
  ]


  });


});



</script>



<div class="profile-column articles"> 


            <div class="centered">
            	<h2>NEWS AND RELEASES</h2>
             </div>


            <div id="article_slider">


                {% for article in articles %} 

                    <div class="article_item"> 

                            <a href="{{ path('entity.node.canonical', {'node':  article.nid.value}) }}">
                            {{ drupal_image(article.field_image.target_id,'medium') }}
                            </a>


                            <div class="article_info profile-column">
                                    <a href="{{ path('entity.node.canonical', {'node':  article.nid.value}) }}"><span class="article_title">{{article.title.value | raw}}</span></a>
                                    <span class="article_body">{{article.body.value | raw}}</span>
                                    <p><span class="article_date">{{ article.revision_timestamp.value|date('F d,Y') }}</span></p>

                                    <div class="link_to">
                                        <a href="{{ path('entity.node.canonical', {'node':  article.nid.value}) }}">
                                        link
                                        </a>
                                    </div>

                            </div>

                    </div>

                {% endfor %}


            </div>



 </div>







<style type="text/css">





</style>



